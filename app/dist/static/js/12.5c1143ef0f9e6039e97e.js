webpackJsonp([12],{fzky:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r("teIl"),n=r("BTaQ"),i=r.n(n),a=r("PJh5"),s=r.n(a),c={components:{iHeader:o.a},name:"",data:function(){var t=this;return{book_id:0,book:[],columns:[{title:"购买书籍",key:"msg",render:function(t,e){return t("div",[t("img",{attrs:{height:"100px",src:e.row.msg.img}}),t("span",e.row.msg.name)])}},{title:"分类",key:"category"},{title:"出版商",key:"publisher"},{title:"单价",key:"price"},{title:"数量",key:"number",render:function(e,r){return e("div",[e("span",{style:{"margin-right":"15px",cursor:"pointer"},on:{click:function(){t.book[0].number=+t.book[0].number-1,t.book[0].sum=t.toDecimal2(t.book[0].number*t.book[0].truePrice/100)}}},[e("Icon",{props:{type:"chevron-left"}})]),r.row.number,e("span",{style:{"margin-left":"15px",cursor:"pointer"},on:{click:function(){t.book[0].number=+t.book[0].number+1,t.book[0].sum=t.toDecimal2(t.book[0].number*t.book[0].truePrice/100)}}},[e("Icon",{props:{type:"chevron-right"}})])])}},{title:"优惠方式",key:"discount"},{title:"总金额",key:"sum"}]}},created:function(){var t=this;this.$http.get("user/"+this.$store.state.auth.authUser,{params:{token:this.$store.state.auth.token}}).then(function(e){t.user=e.data,t.user.createTime=s.a.unix(+e.data.created_at).format("YYYY-MM-DD HH:mm:ss")}).catch(function(e){i.a.Notice.error({title:"暂未登录"}),t.$router.push({name:"Index"})}),this.book_id=this.FromString(this.$route.params.book_id),this.$http.get("book/"+this.book_id).then(function(e){var r={msg:{img:e.data.cover,name:e.data.name},category:e.data.category.name,publisher:e.data.publisher,truePrice:e.data.price,price:t.toDecimal2(e.data.price/100),number:1,discount:"无优惠",sum:t.toDecimal2(e.data.price/100)};t.book=[r]}).catch(function(t){}),document.title="新建订单"+window.title_suf},computed:{},methods:{toDecimal2:function(t){var e=(Math.round(100*t)/100).toString(),r=e.indexOf(".");for(r<0&&(r=e.length,e+=".");e.length<=r+2;)e+="0";return"￥"+e},FromString:function(t){return t=Math.round((t-215)/117)},Create:function(){var t=this;this.$Loading.start();var e=new FormData;e.append("book_id",this.book_id),e.append("number",this.book[0].number),e.append("price",this.book[0].number*this.book[0].truePrice);var r={headers:{"Content-Type":"multipart/form-data","Api-Token":this.$store.state.auth.token}};this.$http.post("order/new",e,r).then(function(e){t.$Loading.finish(),t.$Notice.success({title:"创建成功"});t.$router.push({name:"UserInfo",query:{now:"orderCenter"}})}).catch(function(t){i.a.LoadingBar.error(),i.a.Notice.error({title:"出现了一个错误"})})}}},u={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("i-header"),t._v(" "),r("h1",{staticStyle:{"text-align":"center","margin-top":"20px","margin-left":"-60px"}},[t._v("新建订单")]),t._v(" "),r("div",{staticClass:"order"},[r("Table",{attrs:{border:"",columns:t.columns,data:t.book}}),t._v(" "),r("div",{staticClass:"create"},[r("Button",{attrs:{type:"error"},on:{click:function(e){t.Create()}}},[t._v("创建订单")])],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(c,u,!1,function(t){r("tw1S")},"data-v-57e42d26",null);e.default=d.exports},oU0D:function(t,e,r){(t.exports=r("FZ+f")(!1)).push([t.i,".order[data-v-57e42d26]{width:90%;margin:50px}.create[data-v-57e42d26]{margin-top:20px;margin-right:20px;text-align:right}",""])},tw1S:function(t,e,r){var o=r("oU0D");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);r("rjj0")("1797bd78",o,!0,{})}});
//# sourceMappingURL=12.5c1143ef0f9e6039e97e.js.map