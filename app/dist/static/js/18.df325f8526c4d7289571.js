webpackJsonp([18],{qpCU:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,".price[data-v-2b904664]{max-width:150px!important}.keyword[data-v-2b904664],.price[data-v-2b904664]{display:inline-block!important;margin-right:20px;margin-left:20px}.keyword[data-v-2b904664]{width:500px!important}.books[data-v-2b904664]{width:370px;display:inline-block;margin:10px 10px 10px 20px}.cover[data-v-2b904664]{max-width:100%;max-height:200px;min-height:140px}.tag[data-v-2b904664]{margin-right:10px}.page[data-v-2b904664]{margin-left:20px;margin-right:100px;float:right}",""])},wi0O:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("teIl"),s=i("OChx"),o={name:"Select",components:{iHeader:a.a,iStar:s.a},data:function(){return{books:[],category:[],minPrice:0,maxPrice:0,keyword:"",sortMethods:[{name:"价格",alias:"price"},{name:"销量",alias:"volume"},{name:"评分",alias:"score"},{name:"上架顺序",alias:"time"}],order:[{name:"降序",alias:"desc"},{name:"升序",alias:"asc"}],total:0,selected:{category:"0",maxPrice:"0",minPrice:"0",sort:"time",order:"desc",cur:1,size:10,keyword:""}}},computed:{},beforeMount:function(){var e=(this.$route.query.query||"").split("-"),t=void 0,i=void 0,a=void 0;for(t in e)""!==(i=e[t])&&""!==(a=i.split(","))[0]&&(this.selected[a[0]]=a[1]);this.minPrice=this.toDecimal2(+this.selected.minPrice/100),this.maxPrice=this.toDecimal2(+this.selected.maxPrice/100),this.selected.cur=+this.selected.cur,this.selected.size=+this.selected.size,this.keyword=this.selected.keyword,"time"===this.selected.sort&&(this.order.pop(),this.selected.order="desc"),this.GetCategory(),this.GetBook(),document.title="图书检索"+window.title_suf},watch:{selected:{handler:function(e,t){var i="",a=void 0;for(a in this.selected)i=i+a+","+this.selected[a]+"-";this.$router.replace({query:{query:i}})},deep:!0}},methods:{GetCategory:function(){var e=this;this.$http.get("category",{params:{}}).then(function(t){e.category=t.data,e.category.splice(0,0,{id:0,name:"不限种类"})}).catch(function(e){})},GetBook:function(){var e=this,t={order:this.selected.sort,direction:this.selected.order,limit:10};0!=+this.selected.category&&(t.category_id=+this.selected.category),0!=+this.selected.minPrice&&(t.min_price=this.selected.minPrice),0!=+this.selected.maxPrice&&(t.max_price=this.selected.maxPrice),""!==this.selected.keyword&&(t.keyword=this.selected.keyword),t.limit=+this.selected.size,t.offset=(+this.selected.cur-1)*+this.selected.size,this.$http.get("book",{params:t}).then(function(t){e.total=+t.headers["x-total"],e.books=t.data}).catch(function(e){})},hasImg:function(e){return null!==e&&"null"!==e&&"NULL"!==e},MinPrice:function(){var e=this.toDecimal2(this.minPrice);e-this.maxPrice>1e-6&&(e=this.maxPrice),e<0&&(e=0),this.minPrice=e,this.selected.minPrice=Math.round(100*e)},MaxPrice:function(){var e=this.toDecimal2(this.maxPrice);this.minPrice-e>1e-6&&(e=this.minPrice),e<0&&(e=0),e>1e5&&(e=1e5),this.maxPrice=e,this.selected.maxPrice=Math.round(100*e)},KeyWord:function(){this.selected.keyword=this.keyword},ToBookDetail:function(e){event.preventDefault(),this.$Loading.start(),this.$router.push({name:"BookDetail",params:{book_id:e}})},toDecimal2:function(e){var t=parseFloat(e);isNaN(t)&&(t=0);var i=(Math.round(100*t)/100).toString(),a=i.indexOf(".");for(a<0&&(a=i.length,i+=".");i.length<=a+2;)i+="0";return i}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"Select"},[i("i-header"),e._v(" "),i("Row",{staticStyle:{"margin-top":"50px","margin-left":"20px"}},[i("Row",[i("Col",[e._v("\n        价格区间：\n        "),i("Row",{staticClass:"price",attrs:{span:"4"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.minPrice,expression:"minPrice"}],staticClass:"ivu-input",attrs:{placeholder:"最低价"},domProps:{value:e.minPrice},on:{change:function(t){e.MinPrice()},input:function(t){t.target.composing||(e.minPrice=t.target.value)}}})]),e._v("\n        ~\n        "),i("Row",{staticClass:"price",attrs:{span:"4"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.maxPrice,expression:"maxPrice"}],staticClass:"ivu-input",attrs:{placeholder:"最高价"},domProps:{value:e.maxPrice},on:{change:function(t){e.MaxPrice()},input:function(t){t.target.composing||(e.maxPrice=t.target.value)}}})]),e._v("\n        (0~0代表不限制)\n      ")],1)],1),e._v(" "),i("Row",{staticStyle:{"margin-top":"10px"}},[i("Col",[e._v("\n        排序方式：\n        "),i("RadioGroup",{attrs:{type:"button"},model:{value:e.selected.sort,callback:function(t){e.$set(e.selected,"sort",t)},expression:"selected.sort"}},e._l(e.sortMethods,function(t,a){return i("Radio",{key:a,staticClass:"tag",attrs:{label:t.alias}},[e._v(e._s(t.name))])}))],1)],1),e._v(" "),i("Row",{staticStyle:{"margin-top":"10px"}},[i("Col",[e._v("\n        升降序：\n        "),i("RadioGroup",{attrs:{type:"button"},model:{value:e.selected.order,callback:function(t){e.$set(e.selected,"order",t)},expression:"selected.order"}},e._l(e.order,function(t,a){return i("Radio",{key:a,staticClass:"tag",attrs:{label:t.alias}},[e._v(e._s(t.name))])}))],1)],1),e._v(" "),i("Row",{staticStyle:{"margin-top":"10px"}},[i("Col",[e._v("\n        关键词：\n        "),i("Row",{staticClass:"keyword"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],staticClass:"ivu-input",attrs:{placeholder:"关键词"},domProps:{value:e.keyword},on:{change:function(t){e.KeyWord()},input:function(t){t.target.composing||(e.keyword=t.target.value)}}})])],1)],1),e._v(" "),i("Row",{staticStyle:{"margin-top":"10px"}},[i("Col",[e._v("\n        图书分类：\n        "),i("RadioGroup",{attrs:{type:"button"},model:{value:e.selected.category,callback:function(t){e.$set(e.selected,"category",t)},expression:"selected.category"}},e._l(e.category,function(t,a){return i("Radio",{key:a,staticClass:"tag",attrs:{label:""+t.id}},[e._v(e._s(t.name))])}))],1)],1)],1),e._v(" "),i("Row",{staticStyle:{"margin-top":"50px"}},[i("Col",[i("div",{staticStyle:{height:"50px"}},[i("Page",{staticClass:"page",attrs:{total:e.total,"show-total":"","show-elevator":"","show-sizer":"",current:e.selected.cur,"page-size":e.selected.size},on:{"on-change":function(t){e.selected.cur=t},"on-page-size-change":function(t){e.selected.size=t}}})],1),e._v(" "),e._l(e.books,function(t,a){return i("Card",{key:"select_"+a,staticClass:"books",attrs:{id:"select_"+a}},[i("p",{attrs:{slot:"title"},slot:"title"},[i("Icon",{attrs:{type:"ios-book-outline"}}),e._v("\n          "+e._s(t.name)+"\n        ")],1),e._v(" "),i("p",{attrs:{slot:"extra"},slot:"extra"},[i("i-star",{attrs:{score:t.score}}),e._v(" "),i("Button",{attrs:{slot:"extra"},on:{click:function(i){e.ToBookDetail(t.id)}},slot:"extra"},[e._v("查看详情")])],1),e._v(" "),i("Row",[i("Col",{attrs:{span:"10"}},[e.hasImg(t.cover)?i("img",{staticClass:"cover",attrs:{src:t.cover}}):i("div",{staticClass:"cover"},[e._v("该书暂无图片")])]),e._v(" "),i("Col",{attrs:{span:"14"}},[e._v("\n            作者： "+e._s(t.author)),i("br"),e._v("\n            分类： "),i("a",[e._v(e._s(t.category.name))]),i("br"),e._v("\n            出版社： "+e._s(t.publisher)),i("br"),e._v("\n            价格： ￥"+e._s(e.toDecimal2(t.price/100))),i("br"),e._v("\n            销量： "+e._s(t.sell_number)+"本\n          ")])],1)],1)}),e._v(" "),i("div",{staticStyle:{height:"50px"}},[i("Page",{staticClass:"page",attrs:{total:e.total,"show-total":"","show-elevator":"","show-sizer":"",current:e.selected.cur,"page-size":e.selected.size},on:{"on-change":function(t){e.selected.cur=t},"on-page-size-change":function(t){e.selected.size=t}}})],1)],2)],1)],1)},staticRenderFns:[]};var c=i("VU/8")(o,r,!1,function(e){i("xcLk")},"data-v-2b904664",null);t.default=c.exports},xcLk:function(e,t,i){var a=i("qpCU");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("5b0e5264",a,!0,{})}});
//# sourceMappingURL=18.df325f8526c4d7289571.js.map