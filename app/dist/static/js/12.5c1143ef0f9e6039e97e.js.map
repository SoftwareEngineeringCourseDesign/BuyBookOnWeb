{"version":3,"sources":["webpack:///src/components/user/CreateOrder.vue","webpack:///./src/components/user/CreateOrder.vue?252a","webpack:///./src/components/user/CreateOrder.vue","webpack:///./src/components/user/CreateOrder.vue?ea69","webpack:///./src/components/user/CreateOrder.vue?7212"],"names":["CreateOrder","components","iHeader","Header","name","data","_this","this","book_id","book","columns","title","key","render","h","params","attrs","height","src","row","msg","img","style","margin-right","cursor","on","click","number","sum","toDecimal2","truePrice","props","type","margin-left","created","_this2","$http","get","$store","state","auth","authUser","token","then","r","user","createTime","moment_default","a","unix","created_at","format","catch","e","iview_default","Notice","error","$router","push","FromString","$route","cover","category","publisher","price","discount","document","window","title_suf","computed","methods","x","s","Math","round","toString","rs","indexOf","length","id","Create","_this3","$Loading","start","formData","FormData","append","config","headers","Content-Type","Api-Token","post","finish","$Notice","success","query","now","LoadingBar","user_CreateOrder","_vm","_h","$createElement","_c","_self","_v","staticStyle","text-align","margin-top","staticClass","border","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","module","exports","i","content","locals"],"mappings":"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","file":"static/js/12.5c1143ef0f9e6039e97e.js","sourcesContent":["<template>\n  <div>\n    <i-header></i-header>\n    <h1 style=\"text-align: center; margin-top: 20px; margin-left: -60px;\">新建订单</h1>\n    <div class=\"order\">\n      <Table\n        border\n        :columns=\"columns\"\n        :data=\"book\"\n      >\n      </Table>\n      <div class=\"create\">\n        <Button type=\"error\" @click=\"Create()\">创建订单</Button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport iHeader from '../Header.vue'\nimport iView from 'iview'\nimport moment from 'moment'\nexport default {\n  components: {\n    iHeader\n  },\n  name: '',\n  data () {\n    return {\n      book_id: 0,\n      book: [],\n      columns: [\n        {\n          title: '购买书籍',\n          key: 'msg',\n          render: (h, params) => {\n            return h('div', [\n              h('img', {\n                attrs: {\n                  height: '100px',\n                  src: params.row.msg.img\n                }\n              }),\n              h('span', params.row.msg.name)\n            ])\n          }\n        },\n        {\n          title: '分类',\n          key: 'category'\n        },\n        {\n          title: '出版商',\n          key: 'publisher'\n        },\n        {\n          title: '单价',\n          key: 'price'\n        },\n        {\n          title: '数量',\n          key: 'number',\n          render: (h, params) => {\n            return h('div', [\n              h('span', {\n                style: {\n                  'margin-right': '15px',\n                  cursor: 'pointer'\n                },\n                on: {\n                  click: () => {\n                    this.book[0].number = +this.book[0].number - 1\n                    this.book[0].sum = this.toDecimal2(this.book[0].number * this.book[0].truePrice / 100)\n                  }\n                }\n              }, [\n                h('Icon', {\n                  props: {\n                    type: 'chevron-left'\n                  }\n                })\n              ]),\n              params.row.number,\n              h('span', {\n                style: {\n                  'margin-left': '15px',\n                  cursor: 'pointer'\n                },\n                on: {\n                  click: () => {\n                    this.book[0].number = +this.book[0].number + 1\n                    this.book[0].sum = this.toDecimal2(this.book[0].number * this.book[0].truePrice / 100)\n                  }\n                }\n              }, [\n                h('Icon', {\n                  props: {\n                    type: 'chevron-right'\n                  }\n                })\n              ])\n            ])\n          }\n        },\n        {\n          title: '优惠方式',\n          key: 'discount'\n        },\n        {\n          title: '总金额',\n          key: 'sum'\n        }\n      ]\n    }\n  },\n  created: function () {\n    this.$http.get('user/' + this.$store.state.auth.authUser, {params: {token: this.$store.state.auth.token}})\n      .then((r) => {\n        this.user = r.data\n        this.user.createTime = moment.unix(+r.data.created_at).format('YYYY-MM-DD HH:mm:ss')\n      })\n      .catch((e) => {\n        iView.Notice.error({title: '暂未登录'})\n        this.$router.push({ name: 'Index' })\n      })\n    this.book_id = this.FromString(this.$route.params.book_id)\n    this.$http.get('book/' + this.book_id)\n      .then(r => {\n        let book = {\n          msg: {\n            img: r.data.cover,\n            name: r.data.name\n          },\n          category: r.data.category.name,\n          publisher: r.data.publisher,\n          truePrice: r.data.price,\n          price: this.toDecimal2(r.data.price / 100),\n          number: 1,\n          discount: '无优惠',\n          sum: this.toDecimal2(r.data.price / 100)\n        }\n        this.book = [\n          book\n        ]\n      })\n      .catch(e => {\n      })\n    document.title = '新建订单' + window.title_suf\n  },\n  computed: {\n  },\n  methods: {\n    toDecimal2: function (x) {\n      let f = Math.round(x * 100) / 100\n      let s = f.toString()\n      let rs = s.indexOf('.')\n      if (rs < 0) {\n        rs = s.length\n        s += '.'\n      }\n      while (s.length <= rs + 2) {\n        s += '0'\n      }\n      return '￥' + s\n    },\n    FromString (id) {\n      id = Math.round((id - 215) / 117)\n      return id\n    },\n    Create () {\n      this.$Loading.start()\n      let formData = new FormData()\n      formData.append('book_id', this.book_id)\n      formData.append('number', this.book[0].number)\n      formData.append('price', this.book[0].number * this.book[0].truePrice)\n      let config = {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          'Api-Token': this.$store.state.auth.token\n        }\n      }\n      this.$http.post('order/new', formData, config)\n        .then(r => {\n          this.$Loading.finish()\n          this.$Notice.success({ title: '创建成功' })\n          let now = 'orderCenter'\n          this.$router.push({ name: 'UserInfo', query: { now } })\n        })\n        .catch(e => {\n          iView.LoadingBar.error()\n          iView.Notice.error({title: '出现了一个错误'})\n        })\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .order {\n    width: 90%;\n    margin: 50px;\n  }\n  .create {\n    margin-top: 20px;\n    margin-right: 20px;\n    text-align: right;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/user/CreateOrder.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('i-header'),_vm._v(\" \"),_c('h1',{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"20px\",\"margin-left\":\"-60px\"}},[_vm._v(\"新建订单\")]),_vm._v(\" \"),_c('div',{staticClass:\"order\"},[_c('Table',{attrs:{\"border\":\"\",\"columns\":_vm.columns,\"data\":_vm.book}}),_vm._v(\" \"),_c('div',{staticClass:\"create\"},[_c('Button',{attrs:{\"type\":\"error\"},on:{\"click\":function($event){_vm.Create()}}},[_vm._v(\"创建订单\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-57e42d26\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/iview-loader??ref--1-1!./src/components/user/CreateOrder.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!vue-style-loader!css-loader?minimize!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-57e42d26\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!../../../node_modules/iview-loader/index.js??ref--1-1!./CreateOrder.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!../../../node_modules/iview-loader/index.js??ref--1-1!./CreateOrder.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!../../../node_modules/iview-loader/index.js??ref--1-1!./CreateOrder.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-57e42d26\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!../../../node_modules/iview-loader/index.js??ref--1-1!./CreateOrder.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-57e42d26\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/user/CreateOrder.vue\n// module id = null\n// module chunks = ","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".order[data-v-57e42d26]{width:90%;margin:50px}.create[data-v-57e42d26]{margin-top:20px;margin-right:20px;text-align:right}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?minimize!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-57e42d26\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/iview-loader??ref--1-1!./src/components/user/CreateOrder.vue\n// module id = oU0D\n// module chunks = 12","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-57e42d26\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!../../../node_modules/iview-loader/index.js??ref--1-1!./CreateOrder.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"1797bd78\", content, true, {});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-style-loader!./node_modules/css-loader?minimize!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-57e42d26\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/iview-loader??ref--1-1!./src/components/user/CreateOrder.vue\n// module id = tw1S\n// module chunks = 12"],"sourceRoot":""}